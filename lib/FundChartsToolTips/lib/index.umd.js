/*!
 * FundCharts@description: web/weapp/nodejs canvas lite charts library.
 * @version: 1.0.0
 * @author: Wayne
 * @time: 2018~2025
 */
!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports):"function"==typeof define&&define.amd?define(["exports"],o):o((t="undefined"!=typeof globalThis?globalThis:t||self).FundChartsToolTips={})}(this,(function(t){"use strict";var o="undefined"!=typeof wx&&void 0!==wx.getSystemInfoSync,i={isWeapp:o,dpr:o?wx.getSystemInfoSync().pixelRatio||1:window.devicePixelRatio||1,circularAngle:2*Math.PI,width:70,height:20,font:"10px Arial",pieFont:"bold 22px Arial",labelFont:"bold 12px Arial",textAlign:"center",colors:{color:"#fff",backgroundColor:"#bdbdbd",valColor:"#eee"}},e=i.circularAngle;function l(t){return~~(t/2)}function r(t){return void 0===t}function a(t){return"function"==typeof t}function n(t,o,i){return"function"==typeof t?t(o):"string"==typeof t?t:r(i)?o:i}function s(t,o,i){return t<o?o:t>i?i:t}var h=i.isWeapp?function(t){a(t.draw)&&t.draw(!0)}:function(){return""};function c(t){return function(o,i,e,l,r){if(!this.ctx)throw new Error("canvas `ctx` is not found. Please check `this` point.(FundChartsToolTip)");t.call(this,{xData:e,yDatas:i,xPos:l,yPos:r,index:o})}}function d(t){var o=t.ctx,i=t.x,l=t.y,a=t.color,n=t.strokeColor,s=t.width,h=t.strokeWidth;o.beginPath(),o.lineWidth=0,o.strokeStyle=n||"#fff",o.lineWidth=r(h)?1:h,o.arc(i,l,s,0,e,!0),o.closePath(),o.fillStyle=a,o.fill(),h&&o.stroke()}var f=i.colors,x=c((function(t){var o=t.xData,e=t.yDatas,r=t.xPos,n=this.ctx,c=this.opts,d=c.toolTip||{},x=d.width,v=void 0===x?i.width:x,p=d.height,T=void 0===p?i.height:p,y=d.font,u=void 0===y?i.font:y,g=d.color,w=void 0===g?f.color:g,b=d.textAlign,P=void 0===b?i.textAlign:b,S=d.backgroundColor,A=void 0===S?f.backgroundColor:S,k=d.showTip;n.save(),n.beginPath(),n.fillStyle=A;var C=r-l(v),m=this._chart.width-c.chartRight-v;C=s(C,c.chartLeft,m),n.fillRect(C,c.chartTop+5,v,T),n.fillStyle=w,n.font=u,n.textAlign=P;var F=a(k)&&k(o,e)||k||o+":"+e.map((function(t){return t.toFixed(2)})).join(",");n.fillText(F,C+l(v),c.chartTop+15),n.closePath(),n.stroke(),n.restore(),h(n)})),v=c((function(t){var o=t.xData,e=t.yDatas,r=t.xPos,n=t.index,c=this.ctx,d=this.opts,x=d.toolTip||{},v=x.width,p=void 0===v?i.width:v,T=x.height,y=void 0===T?i.height:T,u=x.font,g=void 0===u?i.font:u,w=x.color,b=void 0===w?f.color:w,P=x.textAlign,S=void 0===P?i.textAlign:P,A=x.backgroundColor,k=void 0===A?f.backgroundColor:A,C=x.top,m=void 0===C?12:C,F=x.showTip;c.save(),c.beginPath();var R=this._chart,L=this.datasets,W=this.barWidth;c.strokeStyle=k,c.fillStyle=k;var D=r-l(p),M=R.width-d.chartRight-p;D=s(D,d.chartLeft,M);var _=L[0][n].x,Y=L[0][n].y;W&&(_+=l(this.barWidth),Y=Math.min.apply(null,L.map((function(t){return t[n].y}))));var j=Y+(this.drawer.zeroY&&Y>this.drawer.zeroY?m:-(y+m)),z=!0;j<d.chartTop&&(z=!1,j=d.chartTop);var B=j+y;W&&this.drawer.zeroY&&j>this.drawer.zeroY&&(B=j),j+y>R.height-25&&(z=!1,j=R.height-25-y),c.fillRect(D,j,p,y),z&&function(t,o){3===(null==o?void 0:o.length)&&(t.beginPath(),t.moveTo(o[0].x,o[0].y),t.lineTo(o[1].x,o[1].y),t.lineTo(o[2].x,o[2].y),t.closePath(),t.fill())}(c,[{x:Math.max(_-3,D),y:B},{x:Math.min(_+3,D+p),y:B},{x:_,y:B+5*(B>j?1:-1)}]),c.fillStyle=b,c.font=g,c.textAlign=S;var V=a(F)&&F(o,e)||F||o+":"+e.map((function(t){return t.toFixed(2)})).join(",");c.fillText(V,D+l(p),j+10),c.closePath(),c.stroke(),c.restore(),h(c)})),p=c((function(t){var o=t.xData,e=t.xPos,r=t.yPos;e=Math.abs(e),r=Math.abs(r);var c=this.ctx,d=this.opts,x=d.toolTip||{},v=x.xWidth,p=void 0===v?i.width:v,T=x.xHeight,y=void 0===T?15:T,u=x.yWidth,g=void 0===u?40:u,w=x.yHeight,b=void 0===w?15:w,P=x.font,S=void 0===P?i.font:P,A=x.color,k=void 0===A?f.color:A,C=x.textAlign,m=void 0===C?i.textAlign:C,F=x.backgroundColor,R=void 0===F?f.backgroundColor:F,L=x.showTip,W=x.showValTip;c.save(),c.beginPath();var D=this._chart;c.strokeStyle=R,c.fillStyle=R;var M=e-l(p),_=l(b),Y=D.width-d.chartRight-p,j=D.height-40;M=s(M,d.chartLeft,Y),_=s(M,d.chartTop,j),c.fillRect(M,j,p,y),c.fillRect(d.chartLeft,_,g,b),c.fillStyle=k,c.font=S,c.textAlign=m,c.fillText(a(L)&&L(o)||L||o,M+l(p),j+8);var z=((r-this.drawer.yBasic)/this.drawer.yRate).toFixed(2);c.fillText(n(W,z),d.chartLeft+l(g),_+8),c.closePath(),c.stroke(),c.restore(),h(c)})),T=i.colors,y=c((function(t){var o=t.yDatas,e=t.index,l=this.ctx,r=this.opts,n=(this.drawer||{}).origin,s=r.toolTip||{},c=s.font,d=void 0===c?i.pieFont:c,f=s.color,x=s.valColor,v=void 0===x?T.valColor:x,p=s.textAlign,y=void 0===p?i.textAlign:p,u=s.valY,g=void 0===u?n.y:u,w=s.showTip,b=s.showValTip;l.save(),l.fillStyle=f||r.colors[e],l.font=d,l.textAlign=y;var P=a(w)&&w(e)||w||"";l.fillText(P,n.x,g-10),l.fillStyle=v;var S=a(b)&&b(o[0])||b||(100*o[0]).toFixed(1);l.fillText(S,n.x,g+15),l.restore(),h(l)})),u=c((function(t){var o=t.yDatas,e=t.index,l=this,r=l.ctx,s=l.opts,c=l.drawer,d=s.toolTip||{},f=d.font,x=void 0===f?i.labelFont:f,v=d.color,p=d.valColor,y=void 0===p?T.valColor:p,u=d.textAlign,g=void 0===u?i.textAlign:u,w=d.showTip,b=d.showValTip;r.save();var P=c.origin,S=c.radius,A=c.centerArr,k=Math.sin(A[e])*S,C=Math.cos(A[e])*S;s.widthRates&&(k*=s.widthRates[e]||1,C*=s.widthRates[e]||1);var m=s.chartLeft,F=this._chart.width-m;r.beginPath(),r.moveTo(P.x+C,P.y+k),r.lineTo(P.x+1.2*C,P.y+1.2*k),r.lineTo(C>0?F-20:m+20,P.y+1.2*k),r.strokeStyle=r.fillStyle=s.colors[e],r.lineWidth=1,r.stroke(),r.font=x,r.textAlign=g,r.textBaseline="middle",r.fillStyle=v||s.colors[e];var R=a(w)&&w(e)||w||"";r.fillText(R,C>0?F:m,P.y+1.2*k-10),r.fillStyle=y;var L=n(b,String(o[0]),(100*o[0]).toFixed(2));r.fillText(L,C>0?F:m,P.y+1.2*k+5),r.closePath(),r.restore(),h(r)})),g=c((function(t){var o=t.yDatas,e=t.index,l=this.ctx,r=this.opts,s=r.toolTip||{},c=s.font,f=void 0===c?i.labelFont:c,x=s.color,v=s.valColor,p=void 0===v?T.valColor:v,y=s.valY,u=s.valX,g=s.showTip,w=s.showValTip;l.save();var b=this.side,P=this.drawer.origin,S=this.dataset,A=this._chart.width,k=u;k||(k=P.x>A/2?r.chartLeft+20:A-r.chartRight-70);var C=y||P.y,m={ctx:l,x:k,y:0,color:"",strokeColor:"",width:4,strokeWidth:1};b?S.forEach((function(t,o){m.y=C-4+15*o,m.color=m.strokeColor=r.colors[o],d(m)})):(m.y=C-4,m.color=m.strokeColor=r.colors[e],d(m)),l.font=f;var F=a(g)&&g(e)||g||"";if(b)S.forEach((function(t,i){l.fillStyle=x||r.colors[i],l.fillText(F,k+10,C+15*i);var e=n(w,String(o[0]),(1*o[0]).toFixed(2));l.fillStyle=p,l.fillText(e,k+l.measureText(F).width+15,C+15*i)}));else{l.fillStyle=x||r.colors[e],l.fillText(F,k+10,C);var R=n(w,String(o[0]),(100*o[0]).toFixed(2));l.fillText(R,k+l.measureText(F).width+15,C)}l.restore(),h(l)})),w={BasicToolTip:x,ArrowToolTip:v,KlineToolTip:p,PieCenterToolTip:y,PieLabelToolTip:u,LabelsToolTip:g};t.ArrowToolTip=v,t.BasicToolTip=x,t.KlineToolTip=p,t.LabelsToolTip=g,t.PieCenterToolTip=y,t.PieLabelToolTip=u,t.default=w,Object.defineProperty(t,"__esModule",{value:!0})}));
