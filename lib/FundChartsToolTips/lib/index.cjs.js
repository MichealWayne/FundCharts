/*!
 * FundCharts@description: web/weapp/nodejs canvas lite charts library.
 * @version: 1.0.0
 * @author: Wayne
 * @time: 2018~2025
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t="undefined"!=typeof wx&&void 0!==wx.getSystemInfoSync,o={isWeapp:t,dpr:t?wx.getSystemInfoSync().pixelRatio||1:window.devicePixelRatio||1,circularAngle:2*Math.PI,width:70,height:20,font:"10px Arial",pieFont:"bold 22px Arial",labelFont:"bold 12px Arial",textAlign:"center",colors:{color:"#fff",backgroundColor:"#bdbdbd",valColor:"#eee"}},i=o.circularAngle;function e(t){return~~(t/2)}function l(t){return void 0===t}function r(t){return"function"==typeof t}function a(t,o,i){return"function"==typeof t?t(o):"string"==typeof t?t:l(i)?o:i}function n(t,o,i){return t<o?o:t>i?i:t}var s=o.isWeapp?function(t){r(t.draw)&&t.draw(!0)}:function(){return""};function h(t){return function(o,i,e,l,r){if(!this.ctx)throw new Error("canvas `ctx` is not found. Please check `this` point.(FundChartsToolTip)");t.call(this,{xData:e,yDatas:i,xPos:l,yPos:r,index:o})}}function c(t){var o=t.ctx,e=t.x,r=t.y,a=t.color,n=t.strokeColor,s=t.width,h=t.strokeWidth;o.beginPath(),o.lineWidth=0,o.strokeStyle=n||"#fff",o.lineWidth=l(h)?1:h,o.arc(e,r,s,0,i,!0),o.closePath(),o.fillStyle=a,o.fill(),h&&o.stroke()}var d=o.colors,f=h((function(t){var i=t.xData,l=t.yDatas,a=t.xPos,h=this.ctx,c=this.opts,f=c.toolTip||{},x=f.width,v=void 0===x?o.width:x,p=f.height,T=void 0===p?o.height:p,y=f.font,g=void 0===y?o.font:y,u=f.color,w=void 0===u?d.color:u,b=f.textAlign,P=void 0===b?o.textAlign:b,S=f.backgroundColor,A=void 0===S?d.backgroundColor:S,k=f.showTip;h.save(),h.beginPath(),h.fillStyle=A;var C=a-e(v),R=this._chart.width-c.chartRight-v;C=n(C,c.chartLeft,R),h.fillRect(C,c.chartTop+5,v,T),h.fillStyle=w,h.font=g,h.textAlign=P;var m=r(k)&&k(i,l)||k||i+":"+l.map((function(t){return t.toFixed(2)})).join(",");h.fillText(m,C+e(v),c.chartTop+15),h.closePath(),h.stroke(),h.restore(),s(h)})),x=h((function(t){var i=t.xData,l=t.yDatas,a=t.xPos,h=t.index,c=this.ctx,f=this.opts,x=f.toolTip||{},v=x.width,p=void 0===v?o.width:v,T=x.height,y=void 0===T?o.height:T,g=x.font,u=void 0===g?o.font:g,w=x.color,b=void 0===w?d.color:w,P=x.textAlign,S=void 0===P?o.textAlign:P,A=x.backgroundColor,k=void 0===A?d.backgroundColor:A,C=x.top,R=void 0===C?12:C,m=x.showTip;c.save(),c.beginPath();var F=this._chart,L=this.datasets,W=this.barWidth;c.strokeStyle=k,c.fillStyle=k;var D=a-e(p),M=F.width-f.chartRight-p;D=n(D,f.chartLeft,M);var _=L[0][h].x,Y=L[0][h].y;W&&(_+=e(this.barWidth),Y=Math.min.apply(null,L.map((function(t){return t[h].y}))));var z=Y+(this.drawer.zeroY&&Y>this.drawer.zeroY?R:-(y+R)),B=!0;z<f.chartTop&&(B=!1,z=f.chartTop);var V=z+y;W&&this.drawer.zeroY&&z>this.drawer.zeroY&&(V=z),z+y>F.height-25&&(B=!1,z=F.height-25-y),c.fillRect(D,z,p,y),B&&function(t,o){3===(null==o?void 0:o.length)&&(t.beginPath(),t.moveTo(o[0].x,o[0].y),t.lineTo(o[1].x,o[1].y),t.lineTo(o[2].x,o[2].y),t.closePath(),t.fill())}(c,[{x:Math.max(_-3,D),y:V},{x:Math.min(_+3,D+p),y:V},{x:_,y:V+5*(V>z?1:-1)}]),c.fillStyle=b,c.font=u,c.textAlign=S;var j=r(m)&&m(i,l)||m||i+":"+l.map((function(t){return t.toFixed(2)})).join(",");c.fillText(j,D+e(p),z+10),c.closePath(),c.stroke(),c.restore(),s(c)})),v=h((function(t){var i=t.xData,l=t.xPos,h=t.yPos;l=Math.abs(l),h=Math.abs(h);var c=this.ctx,f=this.opts,x=f.toolTip||{},v=x.xWidth,p=void 0===v?o.width:v,T=x.xHeight,y=void 0===T?15:T,g=x.yWidth,u=void 0===g?40:g,w=x.yHeight,b=void 0===w?15:w,P=x.font,S=void 0===P?o.font:P,A=x.color,k=void 0===A?d.color:A,C=x.textAlign,R=void 0===C?o.textAlign:C,m=x.backgroundColor,F=void 0===m?d.backgroundColor:m,L=x.showTip,W=x.showValTip;c.save(),c.beginPath();var D=this._chart;c.strokeStyle=F,c.fillStyle=F;var M=l-e(p),_=e(b),Y=D.width-f.chartRight-p,z=D.height-40;M=n(M,f.chartLeft,Y),_=n(M,f.chartTop,z),c.fillRect(M,z,p,y),c.fillRect(f.chartLeft,_,u,b),c.fillStyle=k,c.font=S,c.textAlign=R,c.fillText(r(L)&&L(i)||L||i,M+e(p),z+8);var B=((h-this.drawer.yBasic)/this.drawer.yRate).toFixed(2);c.fillText(a(W,B),f.chartLeft+e(u),_+8),c.closePath(),c.stroke(),c.restore(),s(c)})),p=o.colors,T=h((function(t){var i=t.yDatas,e=t.index,l=this.ctx,a=this.opts,n=(this.drawer||{}).origin,h=a.toolTip||{},c=h.font,d=void 0===c?o.pieFont:c,f=h.color,x=h.valColor,v=void 0===x?p.valColor:x,T=h.textAlign,y=void 0===T?o.textAlign:T,g=h.valY,u=void 0===g?n.y:g,w=h.showTip,b=h.showValTip;l.save(),l.fillStyle=f||a.colors[e],l.font=d,l.textAlign=y;var P=r(w)&&w(e)||w||"";l.fillText(P,n.x,u-10),l.fillStyle=v;var S=r(b)&&b(i[0])||b||(100*i[0]).toFixed(1);l.fillText(S,n.x,u+15),l.restore(),s(l)})),y=h((function(t){var i=t.yDatas,e=t.index,l=this,n=l.ctx,h=l.opts,c=l.drawer,d=h.toolTip||{},f=d.font,x=void 0===f?o.labelFont:f,v=d.color,T=d.valColor,y=void 0===T?p.valColor:T,g=d.textAlign,u=void 0===g?o.textAlign:g,w=d.showTip,b=d.showValTip;n.save();var P=c.origin,S=c.radius,A=c.centerArr,k=Math.sin(A[e])*S,C=Math.cos(A[e])*S;h.widthRates&&(k*=h.widthRates[e]||1,C*=h.widthRates[e]||1);var R=h.chartLeft,m=this._chart.width-R;n.beginPath(),n.moveTo(P.x+C,P.y+k),n.lineTo(P.x+1.2*C,P.y+1.2*k),n.lineTo(C>0?m-20:R+20,P.y+1.2*k),n.strokeStyle=n.fillStyle=h.colors[e],n.lineWidth=1,n.stroke(),n.font=x,n.textAlign=u,n.textBaseline="middle",n.fillStyle=v||h.colors[e];var F=r(w)&&w(e)||w||"";n.fillText(F,C>0?m:R,P.y+1.2*k-10),n.fillStyle=y;var L=a(b,String(i[0]),(100*i[0]).toFixed(2));n.fillText(L,C>0?m:R,P.y+1.2*k+5),n.closePath(),n.restore(),s(n)})),g=h((function(t){var i=t.yDatas,e=t.index,l=this.ctx,n=this.opts,h=n.toolTip||{},d=h.font,f=void 0===d?o.labelFont:d,x=h.color,v=h.valColor,T=void 0===v?p.valColor:v,y=h.valY,g=h.valX,u=h.showTip,w=h.showValTip;l.save();var b=this.side,P=this.drawer.origin,S=this.dataset,A=this._chart.width,k=g;k||(k=P.x>A/2?n.chartLeft+20:A-n.chartRight-70);var C=y||P.y,R={ctx:l,x:k,y:0,color:"",strokeColor:"",width:4,strokeWidth:1};b?S.forEach((function(t,o){R.y=C-4+15*o,R.color=R.strokeColor=n.colors[o],c(R)})):(R.y=C-4,R.color=R.strokeColor=n.colors[e],c(R)),l.font=f;var m=r(u)&&u(e)||u||"";if(b)S.forEach((function(t,o){l.fillStyle=x||n.colors[o],l.fillText(m,k+10,C+15*o);var e=a(w,String(i[0]),(1*i[0]).toFixed(2));l.fillStyle=T,l.fillText(e,k+l.measureText(m).width+15,C+15*o)}));else{l.fillStyle=x||n.colors[e],l.fillText(m,k+10,C);var F=a(w,String(i[0]),(100*i[0]).toFixed(2));l.fillText(F,k+l.measureText(m).width+15,C)}l.restore(),s(l)})),u={BasicToolTip:f,ArrowToolTip:x,KlineToolTip:v,PieCenterToolTip:T,PieLabelToolTip:y,LabelsToolTip:g};exports.ArrowToolTip=x,exports.BasicToolTip=f,exports.KlineToolTip=v,exports.LabelsToolTip=g,exports.PieCenterToolTip=T,exports.PieLabelToolTip=y,exports.default=u;
