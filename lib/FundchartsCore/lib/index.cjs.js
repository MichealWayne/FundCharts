/*!
 * FundCharts@description: web/weapp/nodejs canvas lite charts library.
 * @version: 1.0.0
 * @author: Wayne
 * @time: 2018~2025
 */
"use strict";var t,e;Object.defineProperty(exports,"__esModule",{value:!0});var n="development"===("undefined"!=typeof global&&(null===(t=global.process)||void 0===t?void 0:t.env)||"undefined"!=typeof window&&window||{}).NODE_ENV,r="undefined"!=typeof wx&&void 0!==wx.getSystemInfoSync,o="undefined"!=typeof window&&!r,i="undefined"!=typeof process&&!!(null===(e=process.versions)||void 0===e?void 0:e.node);function a(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function s(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function u(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}function c(t){return Object.prototype.toString.call(t).replace(/\[object\s|\]/g,"")}function l(t){return"Object"===c(t)}function h(t){return"function"==typeof t}function f(t){return"number"==typeof t&&!isNaN(t)}function p(t){if(!t)return!1;for(var e in t)return!1;return!0}var d=function(){return""};function v(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n);return t}function x(t,e,n){return void 0===e&&(e=""),void 0===n&&(n=""),a(this,void 0,void 0,(function(){return s(this,(function(r){throw new Error("Error!".concat(t,".(FundCharts-").concat(e," ").concat(n,")"))}))}))}function y(t){var e;return/^#([0-9a-fA-F]{3}){1,2}$/.test(t)&&(null===(e=(4===t.length?t.replace(/([0-9a-fA-F])/g,"$1$1"):t).substring(1).match(/.{2}/g))||void 0===e?void 0:e.map((function(t){return parseInt(t,16)})))||[]}var g={width:500,height:500};function w(t,e){var n,r=t.currentStyle?t.currentStyle[e]:null===(n=document.defaultView)||void 0===n?void 0:n.getComputedStyle(t,null).getPropertyValue(e),o=null==r?void 0:r.match(/^(\d+)(\.\d+)?px$/);return o?+o[1]:0}function m(t,e){var n=e.id,r=e.width,o=e.height,i=document.createElement("canvas");return i.id="".concat(n,"Canvas"),i.width=r||w(t,"width")||g.width,i.height=o||w(t,"height")||g.height,t.appendChild(i),i}var C=function t(e,n){var r=this;this.x=0,this.y=0,this.length=function(){return Math.sqrt(r.x*r.x+r.y*r.y)},this.normalize=function(){var e=1/r.length();return new t(r.x*e,r.y*e)},this.add=function(e){return new t(r.x+e.x,r.y+e.y)},this.multiply=function(e){return new t(r.x*e,r.y*e)},this.dot=function(t){return r.x*t.x+r.y*t.y},this.angle=function(t){return 180*Math.acos(r.dot(t)/(r.length()*t.length()))/Math.PI},this.x=e,this.y=n};var b=function(){return"undefined"!=typeof requestAnimationFrame?(b=function(){return requestAnimationFrame},requestAnimationFrame):function(t,e){setTimeout((function(){t(+new Date)}),e)}};function A(t){var e=t.duration||600,n=t.onProcess||d,r=t.onAnimationFinish||d,o=b(),i=null;o((function t(a){if(null===a)return n(1),r(),!1;if(null===i&&(i=a),a-i<e){var s=(a-i)/e;u=s,s=(u/=.5)<1?.5*Math.pow(u,3):.5*(Math.pow(u-2,3)+2),n(s),o(t,23)}else n(1),r();var u;return!0}),23)}exports.DEFAULT_ANIMATION_TIME=600,exports.DEFAULT_CANVAS_SIZE=g,exports.DEFAULT_GRID_CHART_PADDING={top:0,right:15,bottom:30,left:50},exports.NOOP=d,exports.__DEV__=n,exports.addEnvContext=function(t,e,n){(!t||o?t.$el:t.opts.Canvas||r)||x("no chart object to set context","setEnvContext");var i,a=t.opts,s=a.width||500,u=a.height||500;if(o){var c=t.$el;c.style.webkitUserSelect="none",c.style.userSelect="none",i=h(c.getContext)?c:m(c,a)}else if(r){var l="undefined"==typeof wx?null:wx;h(null==l?void 0:l.createCanvasContext)||x("no param {Object} Ctx","setEnvContext");var f=l.createCanvasContext(a.id);i={info:"Weapp native canvas",width:s,height:u,getContext:function(){return f},draw:function(e){if(e)return f.draw(!0);l.drawCanvas({canvasId:a.id,actions:t.ctx.getActions()})}}}else{var p=a.Canvas;a.Canvas||x("no param {Object} Canvas","setEnvContext"),i=p.createCanvas(s,u),a.handleOut&&a.handleOut(i)}return t.canvas=i,t.ctx=i.getContext("2d"),t._chart={width:i.width,height:i.height},n},exports.animate=A,exports.appendCanvasElem=m,exports.clearArc=function(t,e,n){var r=e.x,o=e.y,i=.1;!function e(n,r,o){var a=o-i,s=Math.sqrt(o*o-a*a),u=n-a,c=r-s,l=2*a,h=2*s;i<=o&&(t.clearRect(u,c,l,h),i+=.1,e(n,r,o))}(r,o,n)},exports.cloneArray=function(t,e){return v(t,(function(t,n){e[n]=t})),e},exports.cloneObjDeep=function t(e,n){if(!l(e)||!l(n))return{};for(var r in e)!l(n[r])||p(n[r])?n[r]=n[r]||e[r]:t(e[r],n[r]);return n},exports.drawDashLine=function(t,e,n,r){var o=e.x,i=e.y,a=n.x,s=n.y;void 0===r&&(r=5);var u,c,l=~~((u=a-o,c=s-i,Math.sqrt(Math.pow(u,2)+Math.pow(c,2)))/r);t.beginPath();for(var h=0;h<l;h++)t[1&h?"lineTo":"moveTo"](o+(a-o)/l*h,i+(s-i)/l*h);t.closePath(),t.stroke()},exports.drawLine=function(t,e,n){var r=e.x,o=e.y,i=n.x,a=n.y;t.beginPath(),t.moveTo(r,o),t.lineTo(i,a),t.closePath(),t.stroke()},exports.drawPoint=function(t,e,n,r,o,i){var a=e.x,s=e.y;t.beginPath(),t.strokeStyle=r||"#fff",t.lineWidth=f(i)?i:1,t.arc(a,s,o,0,2*Math.PI,!0),t.closePath(),t.fillStyle=n,t.fill(),i&&t.stroke()},exports.drawRotateText=function(t,e,n,r){t.save(),t.translate(e.x,e.y),t.rotate(n*Math.PI/180),t.fillText(String(r),0,0),t.restore()},exports.each=v,exports.getAxisLimit=function(t){return t?t>2?4*Math.ceil(t/4):1.2*t:1},exports.getColorRgbList=y,exports.getColorRgba=function(t,e){void 0===e&&(e=1);var n=y(t),r=3===n.length;return"rgba(".concat(r?n.join(","):"0,0,0",",").concat(r?e:0,")")},exports.getCurvePoints=function(t){for(var e=.3,n=t.length-2,r=[],o=0;o<n;o++){var i=t[o],a=t[o+1],s=t[o+2],u=new C(i.x-a.x,i.y-a.y),c=new C(s.x-a.x,s.y-a.y),l=u.length(),h=c.length(),f=u.normalize().add(c.normalize()).normalize(),p=new C(f.y,-1*f.x),d=new C(-1*f.y,f.x);if(p.angle(u)<90){var v=p.multiply(l*e).add(a),x=d.multiply(h*e).add(a);r.push(v,x)}else{v=p.multiply(h*e).add(a),x=d.multiply(l*e).add(a);r.push(x,v)}}return r},exports.getElementSize=w,exports.getLightfulRgbList=function(t,e){return void 0===e&&(e=0),y(t).map((function(t){return Math.min(255,t+Math.round(t*e))}))},exports.getListExtremum=function(t){if(!t.length)return{max:0,min:0};for(var e=-1/0,n=1/0,r=0,o=t.length;r<o;r++){var i=t[r];i>e&&(e=i),i<n&&(n=i)}return{max:e,min:n}},exports.getPointsAngle=function(t,e){var n=t.x,r=t.y,o=e.x,i=e.y,a=Math.atan2(o-n,r-i);return a<0?2*Math.PI+a:a},exports.getPointsDistance=function(t,e){var n=t.x,r=t.y,o=e.x,i=e.y;return Math.sqrt(Math.pow(n-o,2)+Math.pow(r-i,2))},exports.isArray=function(t){return"Array"===c(t)},exports.isEmptyObj=p,exports.isFunction=h,exports.isNode=i,exports.isNumber=f,exports.isObject=l,exports.isString=function(t){return"string"==typeof t},exports.isTransparentColor=function(t){return!!t&&"0)"===t.replace(/\s/g,"").slice(-2)},exports.isUndefined=function(t){return void 0===t},exports.isWeapp=r,exports.isWeb=o,exports.mixins=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){Object.assign.apply(Object,u([e.prototype],t,!1))}},exports.retinaScale=function(t,e){var n=window.devicePixelRatio||1;if(1===n)return n;var r=t.width,o=t.height;return t.width=r*n,t.height=o*n,e.scale(n,n),t.style.width="".concat(r,"px"),t.style.height="".concat(o,"px"),n},exports.setAnimationHooks=function(t){t.prototype.setAnimation=function(t){var e=this.chartjs.opts;A({duration:e.duration,onProcess:t,onAnimationFinish:e.onFinish})}},exports.setEnvContext=function(t){(!t||o?t.$el:(null==t?void 0:t.opts.Canvas)||r)||x("no chart object to set context","setEnvContext");var e,n=t.opts,i=n.width||g.width,a=n.height||g.height;if(o){var s=t.$el;s.style.webkitUserSelect="none",s.style.userSelect="none",e=h(s.getContext)?s:m(s,{id:n.id,width:n.width||w(s,"width"),height:n.height||w(s,"height")})}else if(r){var u="undefined"==typeof wx?null:wx;h(null==u?void 0:u.createCanvasContext)||x("no param {Object} Ctx","setEnvContext");var c=u.createCanvasContext(n.id);e={info:"Weapp native canvas",width:i,height:a,getContext:function(){return c},draw:function(e){e?c.draw(!0):u.drawCanvas({canvasId:n.id,actions:t.ctx.getActions()})}}}else{var l=n.Canvas;n.Canvas||x("no param {Object} Canvas","setEnvContext"),e=l.createCanvas(i,a),n.handleOut&&n.handleOut(e)}t.canvas=e,t.ctx=e.getContext("2d"),t._chart={width:e.width,height:e.height}},exports.throwError=x,exports.type=c;
