/*!
 * FundCharts@description: web/weapp/nodejs canvas lite charts library.
 * @version: 1.0.0
 * @author: Wayne
 * @time: 2018~2025
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).FundchartsCore={})}(this,(function(t){"use strict";var n,e,r="development"===("undefined"!=typeof global&&(null===(n=global.process)||void 0===n?void 0:n.env)||"undefined"!=typeof window&&window||{}).NODE_ENV,i="undefined"!=typeof wx&&void 0!==wx.getSystemInfoSync,o="undefined"!=typeof window&&!i,a="undefined"!=typeof process&&!!(null===(e=process.versions)||void 0===e?void 0:e.node);function u(t,n,e,r){return new(e||(e=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function u(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}c((r=r.apply(t,n||[])).next())}))}function c(t,n){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function l(t,n,e){if(e||2===arguments.length)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return t.concat(r||Array.prototype.slice.call(n))}function s(t){return Object.prototype.toString.call(t).replace(/\[object\s|\]/g,"")}function h(t){return"Object"===s(t)}function f(t){return"function"==typeof t}function d(t){return"number"==typeof t&&!isNaN(t)}function v(t){if(!t)return!1;for(var n in t)return!1;return!0}var p=function(){return""};function y(t,n){for(var e=0,r=t.length;e<r;e++)n(t[e],e);return t}function g(t,n,e){return void 0===n&&(n=""),void 0===e&&(e=""),u(this,void 0,void 0,(function(){return c(this,(function(r){throw new Error("Error!".concat(t,".(FundCharts-").concat(n," ").concat(e,")"))}))}))}function x(t){var n;return/^#([0-9a-fA-F]{3}){1,2}$/.test(t)&&(null===(n=(4===t.length?t.replace(/([0-9a-fA-F])/g,"$1$1"):t).substring(1).match(/.{2}/g))||void 0===n?void 0:n.map((function(t){return parseInt(t,16)})))||[]}var w={width:500,height:500};function m(t,n){var e,r=t.currentStyle?t.currentStyle[n]:null===(e=document.defaultView)||void 0===e?void 0:e.getComputedStyle(t,null).getPropertyValue(n),i=null==r?void 0:r.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:0}function b(t,n){var e=n.id,r=n.width,i=n.height,o=document.createElement("canvas");return o.id="".concat(e,"Canvas"),o.width=r||m(t,"width")||w.width,o.height=i||m(t,"height")||w.height,t.appendChild(o),o}var C=function t(n,e){var r=this;this.x=0,this.y=0,this.length=function(){return Math.sqrt(r.x*r.x+r.y*r.y)},this.normalize=function(){var n=1/r.length();return new t(r.x*n,r.y*n)},this.add=function(n){return new t(r.x+n.x,r.y+n.y)},this.multiply=function(n){return new t(r.x*n,r.y*n)},this.dot=function(t){return r.x*t.x+r.y*t.y},this.angle=function(t){return 180*Math.acos(r.dot(t)/(r.length()*t.length()))/Math.PI},this.x=n,this.y=e};var A=function(){return"undefined"!=typeof requestAnimationFrame?(A=function(){return requestAnimationFrame},requestAnimationFrame):function(t,n){setTimeout((function(){t(+new Date)}),n)}};function E(t){var n=t.duration||600,e=t.onProcess||p,r=t.onAnimationFinish||p,i=A(),o=null;i((function t(a){if(null===a)return e(1),r(),!1;if(null===o&&(o=a),a-o<n){var u=(a-o)/n;c=u,u=(c/=.5)<1?.5*Math.pow(c,3):.5*(Math.pow(c-2,3)+2),e(u),i(t,23)}else e(1),r();var c;return!0}),23)}t.DEFAULT_ANIMATION_TIME=600,t.DEFAULT_CANVAS_SIZE=w,t.DEFAULT_GRID_CHART_PADDING={top:0,right:15,bottom:30,left:50},t.NOOP=p,t.__DEV__=r,t.addEnvContext=function(t,n,e){(!t||o?t.$el:t.opts.Canvas||i)||g("no chart object to set context","setEnvContext");var r,a=t.opts,u=a.width||500,c=a.height||500;if(o){var l=t.$el;l.style.webkitUserSelect="none",l.style.userSelect="none",r=f(l.getContext)?l:b(l,a)}else if(i){var s="undefined"==typeof wx?null:wx;f(null==s?void 0:s.createCanvasContext)||g("no param {Object} Ctx","setEnvContext");var h=s.createCanvasContext(a.id);r={info:"Weapp native canvas",width:u,height:c,getContext:function(){return h},draw:function(n){if(n)return h.draw(!0);s.drawCanvas({canvasId:a.id,actions:t.ctx.getActions()})}}}else{var d=a.Canvas;a.Canvas||g("no param {Object} Canvas","setEnvContext"),r=d.createCanvas(u,c),a.handleOut&&a.handleOut(r)}return t.canvas=r,t.ctx=r.getContext("2d"),t._chart={width:r.width,height:r.height},e},t.animate=E,t.appendCanvasElem=b,t.clearArc=function(t,n,e){var r=n.x,i=n.y,o=.1;!function n(e,r,i){var a=i-o,u=Math.sqrt(i*i-a*a),c=e-a,l=r-u,s=2*a,h=2*u;o<=i&&(t.clearRect(c,l,s,h),o+=.1,n(e,r,i))}(r,i,e)},t.cloneArray=function(t,n){return y(t,(function(t,e){n[e]=t})),n},t.cloneObjDeep=function t(n,e){if(!h(n)||!h(e))return{};for(var r in n)!h(e[r])||v(e[r])?e[r]=e[r]||n[r]:t(n[r],e[r]);return e},t.drawDashLine=function(t,n,e,r){var i=n.x,o=n.y,a=e.x,u=e.y;void 0===r&&(r=5);var c,l,s=~~((c=a-i,l=u-o,Math.sqrt(Math.pow(c,2)+Math.pow(l,2)))/r);t.beginPath();for(var h=0;h<s;h++)t[1&h?"lineTo":"moveTo"](i+(a-i)/s*h,o+(u-o)/s*h);t.closePath(),t.stroke()},t.drawLine=function(t,n,e){var r=n.x,i=n.y,o=e.x,a=e.y;t.beginPath(),t.moveTo(r,i),t.lineTo(o,a),t.closePath(),t.stroke()},t.drawPoint=function(t,n,e,r,i,o){var a=n.x,u=n.y;t.beginPath(),t.strokeStyle=r||"#fff",t.lineWidth=d(o)?o:1,t.arc(a,u,i,0,2*Math.PI,!0),t.closePath(),t.fillStyle=e,t.fill(),o&&t.stroke()},t.drawRotateText=function(t,n,e,r){t.save(),t.translate(n.x,n.y),t.rotate(e*Math.PI/180),t.fillText(String(r),0,0),t.restore()},t.each=y,t.getAxisLimit=function(t){return t?t>2?4*Math.ceil(t/4):1.2*t:1},t.getColorRgbList=x,t.getColorRgba=function(t,n){void 0===n&&(n=1);var e=x(t),r=3===e.length;return"rgba(".concat(r?e.join(","):"0,0,0",",").concat(r?n:0,")")},t.getCurvePoints=function(t){for(var n=.3,e=t.length-2,r=[],i=0;i<e;i++){var o=t[i],a=t[i+1],u=t[i+2],c=new C(o.x-a.x,o.y-a.y),l=new C(u.x-a.x,u.y-a.y),s=c.length(),h=l.length(),f=c.normalize().add(l.normalize()).normalize(),d=new C(f.y,-1*f.x),v=new C(-1*f.y,f.x);if(d.angle(c)<90){var p=d.multiply(s*n).add(a),y=v.multiply(h*n).add(a);r.push(p,y)}else{p=d.multiply(h*n).add(a),y=v.multiply(s*n).add(a);r.push(y,p)}}return r},t.getElementSize=m,t.getLightfulRgbList=function(t,n){return void 0===n&&(n=0),x(t).map((function(t){return Math.min(255,t+Math.round(t*n))}))},t.getListExtremum=function(t){if(!t.length)return{max:0,min:0};for(var n=-1/0,e=1/0,r=0,i=t.length;r<i;r++){var o=t[r];o>n&&(n=o),o<e&&(e=o)}return{max:n,min:e}},t.getPointsAngle=function(t,n){var e=t.x,r=t.y,i=n.x,o=n.y,a=Math.atan2(i-e,r-o);return a<0?2*Math.PI+a:a},t.getPointsDistance=function(t,n){var e=t.x,r=t.y,i=n.x,o=n.y;return Math.sqrt(Math.pow(e-i,2)+Math.pow(r-o,2))},t.isArray=function(t){return"Array"===s(t)},t.isEmptyObj=v,t.isFunction=f,t.isNode=a,t.isNumber=d,t.isObject=h,t.isString=function(t){return"string"==typeof t},t.isTransparentColor=function(t){return!!t&&"0)"===t.replace(/\s/g,"").slice(-2)},t.isUndefined=function(t){return void 0===t},t.isWeapp=i,t.isWeb=o,t.mixins=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n){Object.assign.apply(Object,l([n.prototype],t,!1))}},t.retinaScale=function(t,n){var e=window.devicePixelRatio||1;if(1===e)return e;var r=t.width,i=t.height;return t.width=r*e,t.height=i*e,n.scale(e,e),t.style.width="".concat(r,"px"),t.style.height="".concat(i,"px"),e},t.setAnimationHooks=function(t){t.prototype.setAnimation=function(t){var n=this.chartjs.opts;E({duration:n.duration,onProcess:t,onAnimationFinish:n.onFinish})}},t.setEnvContext=function(t){(!t||o?t.$el:(null==t?void 0:t.opts.Canvas)||i)||g("no chart object to set context","setEnvContext");var n,e=t.opts,r=e.width||w.width,a=e.height||w.height;if(o){var u=t.$el;u.style.webkitUserSelect="none",u.style.userSelect="none",n=f(u.getContext)?u:b(u,{id:e.id,width:e.width||m(u,"width"),height:e.height||m(u,"height")})}else if(i){var c="undefined"==typeof wx?null:wx;f(null==c?void 0:c.createCanvasContext)||g("no param {Object} Ctx","setEnvContext");var l=c.createCanvasContext(e.id);n={info:"Weapp native canvas",width:r,height:a,getContext:function(){return l},draw:function(n){n?l.draw(!0):c.drawCanvas({canvasId:e.id,actions:t.ctx.getActions()})}}}else{var s=e.Canvas;e.Canvas||g("no param {Object} Canvas","setEnvContext"),n=s.createCanvas(r,a),e.handleOut&&e.handleOut(n)}t.canvas=n,t.ctx=n.getContext("2d"),t._chart={width:n.width,height:n.height}},t.throwError=g,t.type=s,Object.defineProperty(t,"__esModule",{value:!0})}));
