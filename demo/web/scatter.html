<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0"
    />
    <meta name="format-detection" content="telephone=no" />
    <meta name="apple-touch-fullscreen" content="YES" />

    <link rel="stylesheet" href="css/index.css" />
    <title>FundCharts-散点图</title>
  </head>

  <body>
    <div id="app">
      <h3 class="f-tc u-tit">demo 1: earth-data chart</h3>
      <section
        id="scatter1"
        class="u-part"
        style="
          background: #000 url(https://blog.michealwayne.cn/images/fundchartspics/scatter/earth.jpg);
          background-size: 100% auto;
        "
      ></section>

      <h3 class="f-tc u-tit g-mt20">demo2: multi-data chart</h3>
      <section id="scatter2" class="u-part" s-bg_linear></section>

      <h3 class="f-tc u-tit g-mt20">demo 3: different color chart</h3>
      <section id="scatter3" class="u-part">
        <canvas id="scatter3Chart" width="375" height="220"></canvas>
      </section>

      <h3 class="f-tc u-tit g-mt20">demo 4: bubble chart (气泡图)</h3>
      <section id="scatter4" class="u-part" s-bg_linear2></section>

      <h3 class="f-tc u-tit g-mt20">demo 5: time series scatter chart (时间序列散点图)</h3>
      <section id="scatter5" class="u-part"></section>

      <h3 class="f-tc u-tit g-mt20">demo 6: cluster scatter chart (聚类散点图)</h3>
      <section id="scatter6" class="u-part"></section>
    </div>

    <script src="../../lib/FundCharts/lib/index.umd.js"></script>
    <!-- 引用库 -->
    <script>
      var ScatterChart = FundCharts.scatter;

      // chart 1
      var chart1 = new ScatterChart({
        id: 'scatter1',
        formatXaxisText() {
          return '';
        },
        formatYaxisText() {
          return '';
        },
        noDash: true,
        pointWidths: [5, 3],
        borderRate: 1.5, // 圆点边框
        colors: ['#fe5d4e', '#fe5d4e'],
        datas: [
          [
            [3, 4],
            [3, 6],
            [6, 4],
            [3, 5],
          ],
          [
            [1, 2],
            [2, 5.5],
            [2.5, 5],
            [2, 4],
            [3, 5.5],
            [3.5, 4.4],
            [5, 6],
            [7, 3],
          ],
        ],
      });
      chart1.init();

      // chart 2
      var _arr1 = [],
        _arr2 = [],
        _arr3 = [];
      for (var i = 0; i < 60; i++) {
        if (i % 3 === 0) _arr1.push([Math.random() * 100, Math.random() * 100]);
        if (i % 2 === 0) _arr2.push([Math.random() * 80 + 5, Math.random() * 80 + 5]);
        _arr3.push([Math.random() * 50, Math.random() * 50]);
      }

      var chart2 = new ScatterChart({
        id: 'scatter2',
        font: {
          color: '#eee',
        },
        yaxisfunc: function (data) {
          // 处理y轴展示
          return data.toFixed(0) + '%';
        },
        xaxisfunc: function (data) {
          // 处理x轴展示
          return data.toFixed(0) + '天';
        },
        chartTop: 20, // 距离顶部
        chartLeft: 30, // 距离左边
        chartRight: 1, // 距离右边
        datas: [_arr1, _arr2, _arr3],
      });

      chart2.init();

      // chart 3
      var chart3 = new ScatterChart({
        id: 'scatter3Chart',
        datas: [_arr1, _arr2, _arr3],
        range: {
          // 自定义范围
          x: [0, 120],
          y: [0, 200],
        },
        grid: {
          showGrid: true, // 刻度线
          color: '#999', // 刻度线颜色
          yTickLength: 8,
          xTickLength: 8,
        },
        dash: {
          length: 1,
        },
        font: {
          color: '#eee',
        },
        noPointSide: true, // 无描边
        chartLeft: 25,
        chartRight: 1,
        backgroundColor: '#000', // 背景色
        colors: ['#00f', '#0f0', '#f00'], // 散点颜色
        pointWidths: [2, 2, 2], // 各数据项散点大小
        // noDash: true,           // 没有背景网格
        handleTextY: (ctx, yaxis) => {
          console.log(yaxis);
          ctx.textAlign = 'center';
          ctx.textBaseline = 'middle';
          ctx.font = '10px Arial';
          ctx.fillStyle = '#fff';

          ctx.fillText(yaxis.min.toFixed(0), 10, chart3._chart.height - 30);
          ctx.fillText(yaxis.max.toFixed(0), 10, chart3.opts.chartTop + 10);
          ctx.fillText(
            ((yaxis.max + yaxis.min) / 2).toFixed(0),
            10,
            (chart3._chart.height - chart3.opts.chartTop) / 2 - 10
          );
        },
      });

      chart3.init();

      // chart 4: 气泡图 - 不同大小的散点表示第三个维度
      var bubbleData = [];
      for (var i = 0; i < 40; i++) {
        var x = Math.random() * 80 + 10;
        var y = Math.random() * 60 + 10;
        var size = Math.random() * 8 + 2; // 第三个维度：大小
        bubbleData.push([x, y, size]);
      }

      var chart4 = new ScatterChart({
        id: 'scatter4',
        font: {
          color: '#fff',
          fontSize: {
            x: '12px',
            y: '12px',
          },
        },
        yaxisfunc: function (data) {
          return data.toFixed(0) + 'M';
        },
        xaxisfunc: function (data) {
          return data.toFixed(0) + 'K';
        },
        chartTop: 25,
        chartLeft: 35,
        chartRight: 15,
        backgroundColor: 'rgba(0,0,0,0)',
        colors: ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4'],
        pointWidths: bubbleData.map(item => item[2]), // 使用第三个维度作为点的大小
        borderRate: 0.8,
        dash: {
          color: 'rgba(255,255,255,0.3)',
          length: 2,
        },
        datas: [bubbleData.map(item => [item[0], item[1]])], // 只传递x,y坐标
      });

      chart4.init();

      // chart 5: 时间序列散点图
      var timeSeriesData = [];
      var baseTime = new Date('2023-01-01').getTime();
      for (var i = 0; i < 30; i++) {
        var time = baseTime + i * 24 * 60 * 60 * 1000; // 每天一个数据点
        var value = Math.sin(i * 0.2) * 20 + 50 + Math.random() * 10; // 正弦波 + 噪声
        timeSeriesData.push([i, value]);
      }

      var chart5 = new ScatterChart({
        id: 'scatter5',
        font: {
          color: '#fff',
        },
        chartTop: 25,
        chartLeft: 40,
        chartRight: 15,
        backgroundColor: 'transparent',
        colors: ['#3182ce'],
        pointWidths: [6],
        borderRate: 0.7,
        dash: {
          color: 'rgba(255, 255, 255, 0.4)',
          length: 2,
        },
        grid: {
          showGrid: true,
          color: 'rgba(255, 255, 255, 0.4)',
          yTickLength: 6,
        },
        xaxisfunc: function (data) {
          var date = new Date(baseTime + data * 24 * 60 * 60 * 1000);
          return date.getMonth() + 1 + '/' + date.getDate();
        },
        yaxisfunc: function (data) {
          return data.toFixed(0) + '°C';
        },
        datas: [timeSeriesData],
      });

      chart5.init();

      // chart 6: 聚类散点图
      var cluster1 = [],
        cluster2 = [],
        cluster3 = [];

      // 生成三个聚类
      for (var i = 0; i < 25; i++) {
        // 聚类1: 左下角
        cluster1.push([Math.random() * 20 + 10, Math.random() * 20 + 10]);
        // 聚类2: 右上角
        cluster2.push([Math.random() * 20 + 60, Math.random() * 20 + 60]);
        // 聚类3: 中间
        cluster3.push([Math.random() * 20 + 35, Math.random() * 20 + 35]);
      }

      var chart6 = new ScatterChart({
        id: 'scatter6',
        font: {
          color: '#2d3748',
        },
        chartTop: 25,
        chartLeft: 35,
        chartRight: 15,
        backgroundColor: '#fafafa',
        colors: ['#e53e3e', '#38a169', '#3182ce'], // 红、绿、蓝三个聚类
        pointWidths: [5, 5, 5],
        borderRate: 0.8,
        dash: {
          color: '#e2e8f0',
          length: 2,
        },
        grid: {
          showGrid: true,
          color: '#cbd5e0',
          yTickLength: 6,
        },
        xaxisfunc: function (data) {
          return data.toFixed(0) + 'x';
        },
        yaxisfunc: function (data) {
          return data.toFixed(0) + 'y';
        },
        datas: [cluster1, cluster2, cluster3],
      });

      chart6.init();
    </script>
  </body>
</html>
